package com.clickability.security;

import java.sql.SQLException;

import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

import com.clickability.cms.type.ContentInst;

public class GenericCategorizationTest2 extends PermissionTestUtil{

	// ant test.refresh.props -Dapp=cms -Dwebapp=cms -Dzone.props.dir=d:/dev/properties/test
	

	@BeforeClass
	public void init() {
		initForTests();
	}

	private static User user(){
		return PermissionTestUtil.getGenericUser();
	}

	//****** Content-View tests
	//******
	//****** ContentType: <contentTypeID>,"" (all),'INJECT' 
	//****** WFState: <stateID>,"" (all),'INJECT' 
	//****** IsAssigned: "",true,'INJECT'. (Note 'false' is never assigned to these permissions. A user cannot have permission to view only items not-assigned to them, but not items assigned to them.) 
	//****** CategorySet: MATCH_ALL, MATCH_ANY - There are no permissions with "", because if the category set were intended to be all, the parameter would just not be included in the permission. 
	//****** Category: MATCH_ALL, MATCH_ANY 
	//****** _AllChildren: Not-used in generic permissions. 
	
	@Test(enabled = true)
	public void generic_contentView_full_mAll_mAll_1A_2A() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ALL").add("Category","MATCH_ALL"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_A_2_A");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		processContentInstC(c);

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

	}

	private void processContentInstC(ContentInst c) throws SQLException, Exception {
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		
		/// 9 combinations of B - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of B - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	}
	

	@Test(enabled = true)
	public void generic_contentView_full_mAny_mAll_1A_2A() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ANY").add("Category","MATCH_ALL"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_A_2_A");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		//User has A (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		
		/// 9 combinations of B - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of B - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

	}
	
	
	@Test(enabled = true)
	public void generic_contentView_full_mAll_mAny_1A_2A() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ALL").add("Category","MATCH_ANY"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_A_2_A");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		

		
		/// 9 combinations of B - Root
		
		

		/// 9 combinations of B - A
		
		

		/// 9 combinations of All - Root
		
		

		/// 9 combinations of All - A
		
		processContentInstC(c);

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

	}
	

	@Test(enabled = true)
	public void generic_contentView_full_mAny_mAny_1A_2A() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ANY").add("Category","MATCH_ANY"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_A_2_A");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		//User has A (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		
		/// 9 combinations of B - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of B - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

	}
	

	@Test(enabled = true)
	public void generic_contentView_full_mAll_mAll_1uc_2ab() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ALL").add("Category","MATCH_ALL"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_uc_2_AB");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		
		/// 9 combinations of B - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of B - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

	}
	

	@Test(enabled = true)
	public void generic_contentView_full_mAny_mAll_1uc_2ab() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ANY").add("Category","MATCH_ALL"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_uc_2_AB");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		//User has A (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_AB,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_AB,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_AB,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		
		/// 9 combinations of B - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of B - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

	}
	
	
	@Test(enabled = true)
	public void generic_contentView_full_mAll_mAny_1uc_2ab() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ALL").add("Category","MATCH_ANY"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_uc_2_AB");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		
		/// 9 combinations of B - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of B - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

	}
	

	@Test(enabled = true)
	public void generic_contentView_full_mAny_mAny_1uc_2ab() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ANY").add("Category","MATCH_ANY"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_uc_2_AB");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Single Cat Set Tests
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has Root (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has A + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		//User has A (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B w/ no children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B + children
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//User has B (only children)
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		
		// Grant all cat sets.
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(0,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		// Grant all CS1
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Grant all CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS2,0,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
		
		// Grant all CS1 and CS2
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,0,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	

		// 9 Combinations of Root - Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		// 9 Combinations of Root - A
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_AB,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_AB,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_ROOT,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_AB,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of A - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_A,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		
		/// 9 combinations of B - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of B - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - Root
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		/// 9 combinations of All - A
		
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,true);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,0,null);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_A,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	}
	
	// Inheritance tests.
	
	

	@Test(enabled = true)
	public void generic_contentView_full_mAll_mAll_hierarchy() throws Exception {
		PermissionTestUtil.resetGeneric();
		PermissionTestUtil.addContentTypeParam(0,0,null);
		PermissionTestUtil.addGenericPermission("Content-View",new ParameterList().add("ContentType","INJECT").add("WFState","INJECT").add("IsAssigned","INJECT")
			.add("CategorySet","MATCH_ALL").add("Category","MATCH_ALL"));

		ContentInst c = PermissionTestUtil.getTestContent("generic_1_B_2_CAAA");

		PermissionTestUtil.deleteGenericCategorySetParams();
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//Root
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_ROOT,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//B
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_B,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_B,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_B,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//C
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_C,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_C,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_C,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//CA
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CA,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CA,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CA,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//CAA
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAA,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAA,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAA,null);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//CAAA
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAA,false);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAA,true);
		assert(SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAA,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//CAAAA
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAA,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAA,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAA,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//CAAAAA
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAAA,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAAA,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAAA,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		//CAAAAAA
		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAAAA,false);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAAAA,true);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));

		PermissionTestUtil.deleteGenericCategorySetParams();
		PermissionTestUtil.addCategorySetParam(CS1,CS1_B,false);
		PermissionTestUtil.addCategorySetParam(CS2,CS2_CAAAAAA,null);
		assert(!SecurityManager.hasPermission(user(),"Content-View",new ParameterList(),c.getCategorization().toSecurityCategorization()));
	}
	
}
